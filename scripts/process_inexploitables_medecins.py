# -*- coding: utf-8 -*-

import sys
import pandas as pd


unexploitable_doctors_csv = sys.argv[1]
output_csv = sys.argv[2]

unexploit_df = pd.read_csv(unexploitable_doctors_csv, encoding='utf-8', low_memory=False)

# Merge qualite + prenom to be consistent with exploitable data
unexploit_df['BENEF_PS_QUALITE_NOM_PRENOM'] = unexploit_df.BENEF_PS_QUALITE + ' ' + unexploit_df.BENEF_PS_NOM + ' ' + unexploit_df.BENEF_PS_PRENOM
unexploit_df['BENEF_PS_ADR'] = unexploit_df['BENEF_PS_ADR1']

# Have only professionnal data
unexploit_df['ORIGIN'] = u'Medecin'
output_columns = ['ORIGIN', 'LABO', 'BENEF_PS_QUALITE_NOM_PRENOM', 'BENEF_PS_ADR',
                  'BENEF_PS_QUALIFICATION', 'BENEF_PS_RPPS', 'DECL_CONV_DATE',
                  'DECL_CONV_OBJET', 'DECL_AVANT_MONTANT', 'DECL_AVANT_DATE',
                  'DECL_AVANT_NATURE', 'BENEF_ETUD_ETA']
unexploit_df[output_columns].to_csv(output_csv, encoding='utf-8', index=False)
